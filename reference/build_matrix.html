<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='`build_matrix()` creates a credit migration (i.e., "transition") matrix from
  summarized data representing each credit risk state &amp;amp; a continuous metric
  at two distinct points in time.'><title>Build a migration (transition) matrix — build_matrix • migrate</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/DM_Sans-0.4.9/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build a migration (transition) matrix — build_matrix"><meta property="og:description" content='`build_matrix()` creates a credit migration (i.e., "transition") matrix from
  summarized data representing each credit risk state &amp;amp; a continuous metric
  at two distinct points in time.'><meta property="og:image" content="https://ketchbrookanalytics.github.io/migrate/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">migrate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/migrate.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Build a migration (transition) matrix</h1>
      <small class="dont-index">Source: <a href="https://github.com/ketchbrookanalytics/migrate/blob/HEAD/R/build_matrix.R" class="external-link"><code>R/build_matrix.R</code></a></small>
      <div class="d-none name"><code>build_matrix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>`build_matrix()` creates a credit migration (i.e., "transition") matrix from
  summarized data representing each credit risk state &amp; a continuous metric
  at two distinct points in time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">build_matrix</span><span class="op">(</span><span class="va">data</span>, state_start <span class="op">=</span> <span class="cn">NULL</span>, state_end <span class="op">=</span> <span class="cn">NULL</span>, metric <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A data frame or data frame extension (e.g., a tibble or
data.table) containing a minimum of three (3) column variables representing
a starting credit risk state, an ending credit risk state, and a metric
containing values representing the movement (i.e., "transition) in that
metric between the starting credit risk state point in time and the ending
credit risk state point in time. This style of data frame is output by the
`migrate()` function within this package.</p></dd>


<dt>state_start</dt>
<dd><p>(Optional) A symbol or string, representing the column
variable of the `data` data frame argument that contains the starting
credit risk state values. If left null, function will attempt to find it
for you.</p></dd>


<dt>state_end</dt>
<dd><p>(Optional) A symbol or string, representing the column
variable of the `data` data frame argument that contains the starting
credit risk state values. If left null, function will attempt to find it
for you.</p></dd>


<dt>metric</dt>
<dd><p>(Optional) A symbol or string, representing the column variable
of the `data` data frame argument that contains the metric for which the
grouped difference in value between the starting credit risk state period
and ending credit risk state period was computed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A matrix object, where the first (row) dimension represents the starting
credit risk state, the second (column) dimension represents the ending credit
risk state, and the values within the matrix represent the transitioned
amount based upon the values in the `metric` continuous column variable from
the `data` data frame.</p>


<p>Note: A matrix object can be coerced to a data frame using `as.data.frame()`.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Let `build_matrix()` guess which column variables represent `state_start`,</span></span></span>
<span class="r-in"><span><span class="co"># `state_end` and `metric`</span></span></span>
<span class="r-in"><span><span class="va">mock_credit</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="migrate.html">migrate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    time <span class="op">=</span> <span class="va">date</span>,</span></span>
<span class="r-in"><span>    state <span class="op">=</span> <span class="va">risk_rating</span>,</span></span>
<span class="r-in"><span>    id <span class="op">=</span> <span class="va">customer_id</span>,</span></span>
<span class="r-in"><span>    metric <span class="op">=</span> <span class="va">principal_balance</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">build_matrix</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> === Migrating from: `2020-06-30` --&gt; `2020-09-30` ===</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using `risk_rating_start` as the 'state_start' column variable</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using `risk_rating_end` as the 'state_end' column variable</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using `principal_balance` as the 'metric' column variable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             AAA         AA            A         BBB         BB          B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AAA 0.814939529 0.18449926 0.0005612145 0.000000000 0.00000000 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AA  0.070014774 0.63111068 0.1417133794 0.157161170 0.00000000 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A   0.006651444 0.06533969 0.7059300440 0.173855852 0.04822297 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BBB 0.000000000 0.00000000 0.1248259489 0.654281908 0.13935108 0.08154107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BB  0.000000000 0.00000000 0.0000000000 0.147446202 0.59613689 0.18222712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B   0.000000000 0.00000000 0.0000000000 0.005764373 0.09351403 0.66160481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CCC 0.000000000 0.00000000 0.0000000000 0.000000000 0.00000000 0.12363465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            CCC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AAA 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AA  0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A   0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BBB 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BB  0.07418978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B   0.23911678</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CCC 0.87636535</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify which column variables represent `state_start`, `state_end` and</span></span></span>
<span class="r-in"><span><span class="co"># `metric`</span></span></span>
<span class="r-in"><span><span class="va">mock_credit</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="migrate.html">migrate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    id <span class="op">=</span> <span class="va">customer_id</span>,</span></span>
<span class="r-in"><span>    time <span class="op">=</span> <span class="va">date</span>,</span></span>
<span class="r-in"><span>    state <span class="op">=</span> <span class="va">risk_rating</span>,</span></span>
<span class="r-in"><span>    percent <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">build_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>    state_start <span class="op">=</span> <span class="va">risk_rating_start</span>,</span></span>
<span class="r-in"><span>    state_end <span class="op">=</span> <span class="va">risk_rating_end</span>,</span></span>
<span class="r-in"><span>    metric <span class="op">=</span> <span class="va">count</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> === Migrating from: `2020-06-30` --&gt; `2020-09-30` ===</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     AAA AA  A BBB BB  B CCC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AAA  24  6  1   0  0  0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AA    9 59 14   7  0  0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A     1  8 87  20  4  0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BBB   0  0 10  60 13  5   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BB    0  0  0   9 50 13   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B     0  0  0   1  7 45  19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CCC   0  0  0   0  0  3  18</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Thomas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

